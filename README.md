# Python review 2 Django web service

## Необходимые пакеты

```plain_text
    - django (легко устанавливается с помощью pip)
    - pickle
    - wikipedia (так же устанавливается с помощью pip)
    - numpy, scipy, pandas, sklearn
    - bs4
    - requests
```

## Запускаем приложение локально

Находясь в папке с файлом manage.py (корневой каталог репозитория) выполняем команду python manage.py runserver

## Функционал сервиса

<ссылка, которую даст вам manage.py при запуске>/ - откроет окно с полем ввода. Туда вводим ссылку на статью(английскую) на википедии о фильме и выбираем число похожих.
Жмем энтер и ждем, пока система перенаправит на страницу с результатами (там будет список похожих фильмов с ссылкой и описанием)
<ссылка, которую даст вам manage.py при запуске>/train - тренировать модель. В репозитории модель уже тренирована на 20000 фильмах с описанием на английском.
Процесс тренировки достаточно длительный(если сократить число фильмов до 10000, то процесс ускорится. Решил использовать 20000, так как это оптимальное число
с точки зрения ресурсов и качества).

## Запуск через Docker

1. Соберите Docker-образ:

    ```bash
    docker build -t django-movie-service .
    ```

2. Запустите контейнер:

    ```bash
    docker run -p 8000:8000 django-movie-service
    ```

3. Сервис будет доступен по тому же адресу: <http://localhost:8000>

## Запуск через Docker Compose

1. Запустите сервисы:

    ```bash
    docker-compose up --build
    ```

2. Web-сервис будет доступен по адресу: <http://localhost>

3. Nginx будет проксировать запросы к сервису на порт 8000. Если вы хотите обратиться к приложению, используйте один из следующих URL:

    - Основной интерфейс: <http://localhost/app>
    - Админка: <http://localhost/admin>
    - Health Check: <http://localhost/health>

## Работа с сервисом

### Поиск похожих фильмов

1. На главной странице приложения введите:

    - Ссылку на англоязычную статью Википедии о фильме (например, <https://en.wikipedia.org/wiki/Gladiator_(2000_film)>)
    - Количество рекомендаций (1-10)

2. Нажмите "Search", чтобы отправить запрос на получение рекомендаций. После этого будет создана асинхронная задача, которая обработает запрос.

3. Вы можете отслеживать статус задачи и результат через интерфейс или по следующему API:
    - **Статус задачи** можно проверить по URL: <http://localhost/task_status/{task_id}>
    - Если задача будет успешно выполнена, вы получите список похожих фильмов.

4. Если модель не обучена, будет предложено перейти на страницу для тренировки модели.

В конфиге Nginx используется проксирование запросов на сервис, работающий на порту 8000 (состоящем из контейнера `web`).
